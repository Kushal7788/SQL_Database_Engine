LOAD EMPLOYEE
LOAD WORKS_ON

TEMP11 <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn, Salary FROM TEMP11


CROSS_EMP <- CROSS EMPLOYEE EMPLOYEE
TEMP21 <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM CROSS_EMP
TEMP22 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM TEMP21
Q2 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE1_Super_ssn, EMPLOYEE1_Bdate FROM TEMP22
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE1_Super_ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2


CROSS_WORK <- CROSS EMPLOYEE WORKS_ON
TEMP31 <- SELECT Essn == Ssn FROM CROSS_WORK
MALE <- SELECT Sex == 1 FROM TEMP31
FEMALE <- SELECT Sex == 0 FROM TEMP31
CROSS_ANS <- CROSS MALE FEMALE
TEMP32 <- SELECT MALE_Pno == FEMALE_Pno FROM CROSS_ANS
TEMP33 <- SELECT MALE_Sex != FEMALE_Sex FROM TEMP32
Q3 <- PROJECT MALE_Pno FROM TEMP33
RENAME MALE_Pno TO Pno FROM Q3




TEMP41 <- SELECT Ssn == Essn FROM CROSS_WORK
TEMP42 <- SELECT Super_ssn == Essn FROM CROSS_WORK
CROSS_ANS4 <- CROSS TEMP41 TEMP42
TEMP43 <- SELECT TEMP41_Super_ssn == TEMP42_Essn FROM CROSS_ANS4
TEMP44 <- SELECT TEMP41_Pno == TEMP42_Pno FROM TEMP43
Q4 <- PROJECT TEMP41_Ssn, TEMP42_Essn, TEMP42_Pno FROM TEMP44
RENAME TEMP41_Ssn TO Ssn FROM Q4
RENAME TEMP42_Essn TO Super_ssn FROM Q4
RENAME TEMP42_Pno TO Pno FROM Q4


EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4

QUIT
